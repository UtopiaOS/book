<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Winter - Utopia OS</title>
                

        <!-- Custom HTML head -->
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

                <link rel="icon" href="favicon.svg">
                        <link rel="shortcut icon" href="favicon.png">
                <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
                <link rel="stylesheet" href="css/print.css" media="print">
        
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
                <link rel="stylesheet" href="fonts/fonts.css">
        
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
            </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="title_page.html">The Utopia Operating System</a></li><li class="chapter-item expanded affix "><a href="foreword.html">Foreword</a></li><li class="chapter-item expanded affix "><a href="introduction.html">Introduction</a></li><li class="chapter-item expanded "><a href="chapter_01_getting_started.html"><strong aria-hidden="true">1.</strong> Getting started</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="chapter_01_installing_utopia.html"><strong aria-hidden="true">1.1.</strong> Installing Utopia</a></li><li class="chapter-item expanded "><a href="chapter_01_setup_dev_env.html"><strong aria-hidden="true">1.2.</strong> Set up your dev environment</a></li></ol></li><li class="chapter-item expanded "><a href="chapter_02_the_utopia_proposals.html"><strong aria-hidden="true">2.</strong> The Utopia proposals</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="chapter_02_1_neohfs.html"><strong aria-hidden="true">2.1.</strong> NeoFHS</a></li></ol></li><li class="chapter-item expanded "><a href="chapter_03_the_utopia_components.html"><strong aria-hidden="true">3.</strong> The Utopia components</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="chapter_03_winter.html" class="active"><strong aria-hidden="true">3.1.</strong> Winter</a></li></ol></li><li class="chapter-item expanded "><a href="chapter_04_the_utopia_apis.html"><strong aria-hidden="true">4.</strong> The Utopia APIs</a></li></ol>            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                                                <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                                            </div>

                    <h1 class="menu-title">Utopia OS</h1>

                    <div class="right-buttons">
                                                <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                                                                        
                    </div>
                </div>

                                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h2 id="winter"><a class="header" href="#winter">Winter</a></h2>
<p>Winter is the <a href="https://en.wikipedia.org/wiki/Package_manager">package manager</a> for the Utopia Operating System. It's responsible for installing, updating, and managing <strong>non-critical system components</strong>. Calling Winter a package manager is somewhat misleading, as libigloo is the one actually doing all the heavy lifting and Winter is simply the CLI frontend.</p>
<p>The core system is managed separately from Winter to provide stability, consistency and <a href="https://www.merriam-webster.com/dictionary/immutable">immutability</a>. This means that Winter itself, libSystem (libc), systemd, and others are not managed by Winter. You are also expected to use flatpak to install graphical applications at least for now but this may change depending on the paths Utopia takes in the future.</p>
<h3 id="introduction"><a class="header" href="#introduction">Introduction</a></h3>
<p>Winter is based around the concept of Symlink Style Package Management, meaning winter is designed with support for multiple package versions which has benefits in many areas like preventing partial upgrades and preventing issues if a library has not been updated upstream. You can read more about this approach in the <a href="https://www.linuxfromscratch.org/lfs/view/stable/chapter08/pkgmgt.html">LFS guide about package management</a></p>
<p>Winter is designed to heavily integrate into the Utopia Operating System and take advantage of all the changes we have done, including but not limited to NeoFHS, BigBrother, and the (currently unnamed) global configuration database.</p>
<p>All programs installed with Winter are self-contained and stay in their own directories. Instead of having <code>libfoo</code> installed to <code>/usr/lib/libfoo.so</code> it would be installed to <code>/Programs/libfoo/1.0/lib/libfoo.so</code>. You can still find <code>libfoo.so</code> at <code>/usr/lib/libfoo.so</code> or <code>/System/Index/lib/libfoo.so</code>. As you may have guessed from the version number, Winter supports multiple versions, meaning you can have <code>/Programs/libfoo/2.0/lib/libfoo.so</code> at the same time as version 1.0. Supporting multiple versions is beneficial to many people and prevents many problems. A common issue maintainers of distros run into are scenarios where a program relies on an older version of a library, and it cannot be updated (maybe it's a proprietary program or maybe the developer needs more time to work on updating it) but other programs have been updated to <code>libfoo 2.0</code>. The maintainer now either has to hold back packages requiring <code>libfoo 2.0</code> until the other package is updated or drop the package using the old version of the library. Neither of these scenarios are ideal and inevitably cause dependency hell if a package maintainer doesn't sort this out. By supporting multiple versions, Winter avoids all of this.</p>
<p>A real world scenario is 'bar' is a proprietary program that has not been updated to <code>libfoo 2.0</code>. If this mess hasn't been fixed by maintainers of these packages and your package manager only supports one version at a time the result is your package manager trying to downgrade to <code>libfoo 1.0</code> which might not be in the distro's repos anymore and even if it was the second you try to downgrade you will encounter dependency issues where you can't downgrade <code>libfoo</code> because other packages depend on the latest version. This becomes worse recursively as you realize <code>libfoo 1.0</code> might also depend on older versions of other packages and so on. </p>
<p>While the example above mentions a clear example with an older library being required, sometimes it might be an older version of a certain <em>toolchain</em> or <em>programming language</em> that is required. While certain tools like <code>pyenv</code> have emerged to counter this issue, we would like to see something at the system level.</p>
<p>We aren't the first ones trying to implement something like this (thankfully) so we aren't completely in the dark trying to implement this. Here are some examples of other projects that work this way, and reap the benefits:</p>
<ul>
<li>Homebrew (The most popular package manager for macOS)</li>
<li>NIX</li>
<li>GUIX</li>
<li>GoboLinux</li>
</ul>
<p>Some others have picked up the idea and created a sandbox-like environment:</p>
<ul>
<li>Flatpak</li>
<li>Snap</li>
<li>An example of this marketed towards developers would be <a href="https://docker.io">Docker</a></li>
</ul>
<p>Some miscellaneous benefits of Winter are as follows: </p>
<ul>
<li>Easy to uninstall programs: Thanks to the level of integration that Winter has with the Operating System (A benefit we can have because we control all the userland). You can just remove or &quot;trash&quot; a Program under &quot;/Programs&quot; and Winter will remove the rest.</li>
<li>Virtually no conflicts: Because every package is self-contained, it is possible to install two otherwise conflicting packages (Like the example we mentioned above)</li>
<li>Intuitive design: Stop wondering what package installed that new file in your <code>/lib</code> directory. With Winter, you know exactly what files belong to what program.</li>
</ul>
<!--- Maybe remove this one? most package managers provide tools to see what packages made files -->
<h3 id="a-little-view-inside-winter"><a class="header" href="#a-little-view-inside-winter">A little view inside Winter</a></h3>
<p>Please note: This isn't a full view into the Winter internals. To read more about the Winter internals, you can go to Winter's own book by clicking <a href="https://utopiaos.github.io/winter/book">here</a></p>
<p>Winter installs its packages to <code>/Programs</code>, Packages are stored using the following structure: <code>/Programs/ProgramName/Version</code> so for example. Python 3.8 would be stored like this: <code>/Programs/python/3.8</code>. Inside said folder, we would be able to find the typical directories a Python installation might have:</p>
<pre><code>.
├── bin/
│   ├── 2to3
│   ├── pydoc
│   └── python
├── include/
│   └── python3.8
├── lib64/
│   └── python3.8
└── share/
    └── doc
</code></pre>
<p>The depicted above is of course not the full directory tree, as the default directory tree is thousands of files (2566 to be exact), now here is where symlinks come handy again, Winter then links the files to the <code>/System/Index</code>, so for example: </p>
<pre><code>/Programs/python/3.8/bin/python         -&gt; /System/Index/bin/python
/Programs/python/3.8/bin/2to3           -&gt; /System/Index/bin/2to3
/Programs/python/3.8/bin/pydoc          -&gt; /System/Index/bin/pydoc
/Programs/python/3.8/include/python3.8  -&gt; /System/Index/include/python3.8
/Programs/python/3.8/lib64/python3.8    -&gt; /System/Index/lib/python3.8
/Programs/python/3.8/share/doc          -&gt; /System/Index/share/doc
</code></pre>
<p>The way Winter installs and stores packages allows you to select which version is <em>linked</em> to the System Index with ease. You could install Python 3.9, and you'll see the <code>3.8</code> and <code>3.9</code> subdirectories, then just perform the corresponding Winter command to select the version that you wish to link.</p>
<p>If you would like to read about each Winter command and what they do you can click <a href="https://utopiaos.github.io/winter/book">here</a>.</p>
<p>Some other benefits weren't described here in order to avoid extreme complexity, for example <a href="https://utopiaos.github.io/winter/book">Winter environments</a> weren't described here.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                                                    <a rel="prev" href="chapter_03_the_utopia_components.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        
                                                    <a rel="next" href="chapter_04_the_utopia_apis.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                                    <a rel="prev" href="chapter_03_the_utopia_components.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                
                                    <a rel="next" href="chapter_04_the_utopia_apis.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                            </nav>

        </div>

        
        
        
                <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        
        
                <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
        
    </body>
</html>
