<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Utopia OS</title>
                <meta name="robots" content="noindex" />
                

        <!-- Custom HTML head -->
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

                <link rel="icon" href="favicon.svg">
                        <link rel="shortcut icon" href="favicon.png">
                <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
                <link rel="stylesheet" href="css/print.css" media="print">
        
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
                <link rel="stylesheet" href="fonts/fonts.css">
        
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
            </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="title_page.html">The Utopia Operating System</a></li><li class="chapter-item expanded affix "><a href="foreword.html">Foreword</a></li><li class="chapter-item expanded affix "><a href="introduction.html">Introduction</a></li><li class="chapter-item expanded "><a href="chapter_01_getting_started.html"><strong aria-hidden="true">1.</strong> Getting started</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="chapter_01_installing_utopia.html"><strong aria-hidden="true">1.1.</strong> Installing Utopia</a></li><li class="chapter-item expanded "><a href="chapter_01_setup_dev_env.html"><strong aria-hidden="true">1.2.</strong> Set up your dev environment</a></li></ol></li><li class="chapter-item expanded "><a href="chapter_02_the_utopia_proposals.html"><strong aria-hidden="true">2.</strong> The Utopia proposals</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="chapter_02_1_neohfs.html"><strong aria-hidden="true">2.1.</strong> NeoFHS</a></li></ol></li><li class="chapter-item expanded "><a href="chapter_03_the_utopia_components.html"><strong aria-hidden="true">3.</strong> The Utopia components</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="chapter_03_winter.html"><strong aria-hidden="true">3.1.</strong> Winter</a></li></ol></li><li class="chapter-item expanded "><a href="chapter_04_the_utopia_apis.html"><strong aria-hidden="true">4.</strong> The Utopia APIs</a></li></ol>            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                                                <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                                            </div>

                    <h1 class="menu-title">Utopia OS</h1>

                    <div class="right-buttons">
                                                <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                                                                        
                    </div>
                </div>

                                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="the-utopia-operating-system"><a class="header" href="#the-utopia-operating-system">The Utopia operating system</a></h1>
<p><em>By Diego Magdaleno</em></p>
<p>This version of the text assumes you're somewhat experienced with computers and development, have a basic understanding of UNIX-like operating systems, and that you are running the latest version of Utopia.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="foreword"><a class="header" href="#foreword">Foreword</a></h1>
<p>The vision of the Utopia Operating System was always clear. When it was born, Utopia was primarily about <em>empowerment</em>:
No matter what kind of user you are, Utopia empowers you to use and do the best you can in your computer, Utopia tries to give
wonderful people, wonderful tools, so they can do wonderful things.</p>
<p>Take for example, the state of package managers and the fragmentation the Linux community experiences because of this, Utopia was made with the idea of fixing these fundamental issues, one step at a time, so not only your Operating System feels like one with the computer, but you can also spend less time figure out why things don't work, how to install multiple versions of a package or how to configure this or that tool, Utopia is made for the user.</p>
<p>Utopia was made with the average user in mind, that user that expects things to work out of the box, without compromising power, the idea of Utopia is to keep it simple, as long as you want that to be the case, Utopia was made for integration, everything is integrated as one big system, working together to provide the best experience that any other desktop could provide, Utopia feels natural to the user, is like he always used it, Utopia, was made for the user.</p>
<p>This book, for you, the developer, embraces the power and simplicity Utopia brings to the desktop ecosystem. It's a friendly and approachable text intended to help you just not level up your knowledge of Utopia and develop apps that feel like home, but to also reach the confidence you can use Utopia as your daily operating system. So dive in and get ready to learn -- And welcome to the Utopia community.</p>
<p>-- Diego Magdaleno</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<p>Welcome to <em>The Utopia Operating System</em>, an introductory book about Utopia. The Utopia Operating System, helps you experience a better, simpler and more cohesive computer experience. Operating systems are either too advanced or too simple. Utopia challenges that conflict. Through the community, discussions and personal experiences, Utopia manages to find a balance, between the power user and the user, Utopia gives you the power to control your operating system and computer, without the hassle associated with such control.</p>
<h2 id="who-is-utopia-for"><a class="header" href="#who-is-utopia-for">Who is Utopia for</a></h2>
<p>Utopia is ideal for many people for a varaiety of people, however, in the next sections we look at the biggest and most important ones.</p>
<h2 id="casual-users"><a class="header" href="#casual-users">Casual Users</a></h2>
<p>Utopia is made for the casual user that might their computer to:</p>
<ul>
<li>Watch cat videos</li>
<li>Chat with some friends</li>
<li>Use a web browser</li>
<li>Edit some document file</li>
<li>Play a casual game</li>
</ul>
<p>When using Utopia the computer becomes a tool, Utopia is made for users with varying levels of knowledge about computers, and casual users aren't an execption to the Utopia operating system, with Utopia, the user is free to forget about what Operating system he is using. All thanks to the many tools and principles Utopia follows, the casual user can benefit from principles such as:</p>
<ul>
<li><strong>Apps are self contained bundles</strong>: In Utopia, applications are just folders that contain the &quot;executable&quot;, is not expected to the user to know what any of that means, he just needs to know, he has to right click an app to open it and start enjoying the diverse variety of options the app might bring to his systems.</li>
<li><strong>The global menu</strong>: In Utopia, an user does not need to get user to the hambuguer or the custom menu each app might have, in Utopia, the top bar contains a global menu, which handles all the options the user might have for interacting with the application.</li>
<li><strong>The store</strong>: The store, is powered by libigloo, a UI-first package manager library, this makes the store experience, fast, simple and seamless, because it was designed to be specifically used with the backend and frontend, the user doesn't need to worry about the store showing him weird terminal outputs, or options he doesn't understand, going to the store, is just like in the real world.</li>
<li><strong>The dock</strong>: In Utopia, the favorite apps of the user, are always stored in the bottom-bar also known as the dock, the dock is a centric place, that tells you what applications are open, the option to close them, pin them.</li>
<li><strong>The lauchpad</strong>: The launchpad is a familiar phone-like homescreen that allows the user to see all the apps he hass installed on his computer, and remove them, sort them, or even quickly search to his liking.</li>
</ul>
<p>By using these tools and interfaces, the average user can feel at home while using his computer.</p>
<h2 id="power-users"><a class="header" href="#power-users">Power users</a></h2>
<p>Utopia is made for the power users that might use their computer to:</p>
<ul>
<li>Do heavy gaming</li>
<li>Tweak the computer to their likings</li>
<li>Modify the desktop or other aspects of the operating system</li>
<li>Block certain websites from loading</li>
<li>Modify system services </li>
<li>Modify low level system settings</li>
</ul>
<p>When using Utopia as a power user, your computer is completely yours, you have the power and freedom to disasble, all the systems that prevent you from modifying your system, but as always Utopia empowers you, the power user by providing tools and defaults that might your experience better.</p>
<ul>
<li><strong>Windows apps run by default</strong>: Utopia uses sytemd-winefmt to run windows apps with a double click, while we can't ensure they are going to work as expected, basic apps should give the user an awesome experience out of the box.</li>
<li><strong>System wide configuration api</strong>: The user can format about dotfiles, or having thousands of files in different locations with different formats, Utopia provides a way for you, the developer, to integrate your settings directly into the system in an intuitive way, and for those who like files, Utopia translates settings from it's Database to a FUSE mountpoint in /Settings full of TOML files, so it's like the user has the classic config files.</li>
<li><strong>Scripting</strong>: Utopia empowers the users to perform certain actions, while at the time of writting this document is only planned for moving files around, the Utopia big brother file watcher, allows the user to run POSIX-compliant scripts when a certain action is performed.</li>
<li><strong>A package manager that empowers the user</strong>: Winter is a highly costumizable package manager, you're free to add third party repos, change the vendor of some packages, install propiteraty software, change your kernel, make your own packages, etc, all while being sure, the SAT solver ensures your dependencies dont break.</li>
<li><strong>Multiple versions of the same app</strong>: The power user can forget about doing crazy workarounds to run older versions of the app, just so he can have features that might be removed in newer versions, Utopia is designed so users can run multiple versions of the app by default.</li>
<li><strong>A terminal that helps you</strong>: Utopia ships with a third party terminal, named warp, it combines the aspects of a classic text-based interface and the modernity of having buttons, quick actions and tasks.</li>
</ul>
<p>By using these tools, interfaces and commonidities, a power user can feel even more empowered to mofify and tweak his system.</p>
<h2 id="developers"><a class="header" href="#developers">Developers</a></h2>
<p>Utopia is made for developers that might use their computer to:</p>
<ul>
<li>Edit source code on their computer</li>
<li>Run multiple instances of a program</li>
<li>Debug software</li>
<li>Write documentation on diverse platforms</li>
<li>Need to research an specific topic</li>
</ul>
<p>When using Utopia as a developer, your computer, becomes a powerful tool for writting software, not only you as a developer benefit from all the features that were discussed above, but Utopia provides you, the developer with tools that make developing on Utopia more powerful than ever:</p>
<ul>
<li><strong>Unified package directory</strong>: In Utopia, all your global packages, coming from Python, npm, rubygems, you name it, are unified in a single FUSE mountpoint at /Aliens, which allows you to quickly list the directories, and so, get a quick list of every single package that you might have installed on your system, including third party packages.</li>
<li><strong>Multple versions of the same software</strong>: Does your software require Python 3.9? or Python 3.7?, on other operating systems, you would have to experience the hassle of downlading tools, adding them to your path, and be frustrated because a requirement is not availible, in Utopia, you just need to open your terminal, and use Winter to install the version you desire, after this, you can set which version of the package gets activated per directory.</li>
<li><strong>Developer environments</strong>: The design of Winter allows you the developer to create environemtns that run specific versions of software, so you can link with the proper libraries, or include the right header files.</li>
<li><strong>Alternatives system</strong>: Utopia provides an api for developers to register alternatives to common software, that are more than symlinks, you can set them per directory, for example, one could have one directory, use sh as the main shell, and another using zsh, as both are registred alternatives for a POSIX shell.</li>
<li><strong>LaunchServices</strong>: Do you miss the <code>open</code> command other operating systems have?, well not on Utopia, Utopia introduces its own implementation of LaunchServices, so you can do open your from terminal, and open the file in your favorite app!.</li>
</ul>
<p>By using this apis, inferfaces and tools, the developer can feel at home and more empowered to write software on Utopia, or even for Utopia.</p>
<h2 id="who-is-this-book-for"><a class="header" href="#who-is-this-book-for">Who is this book for</a></h2>
<p>This book assumes you have already used Linux systems, written code in some programming language, and used developer tools, but it doesn't make any assumptions about what programming language you used, what interface you used or what Linux operating system you come from. We try to approach you knowing developers have a variety of backgrounds, so don't worry, we hope this book makes it easy for you, the developer to enjoy and understand our operating system, is which also yours.</p>
<h2 id="how-to-use-this-book"><a class="header" href="#how-to-use-this-book">How to use this book</a></h2>
<p>This book asumes you are reading it from front to back, this means from the title page to the conclusions. It is important you don't skip sections, or chapters, as Utopia design desicions are explained, by building on knowledge you got from previous chapters, and if a chapter does not delve into a topic that is mentioned, we typically come back to it later, just like when you learnt programming.</p>
<h2 id="source-code"><a class="header" href="#source-code">Source code</a></h2>
<p>This book is automatically generated, and the source can get freely edited on <a href="https://github.com/UtopiaOS/book">GitHub</a></p>
<p>Happy learning and coding!</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="getting-started"><a class="header" href="#getting-started">Getting started</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="installing-utopia"><a class="header" href="#installing-utopia">Installing Utopia</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="set-up-your-dev-environment"><a class="header" href="#set-up-your-dev-environment">Set up your dev environment</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="the-utopia-proposals"><a class="header" href="#the-utopia-proposals">The Utopia proposals</a></h1>
<p>In this chapter, you will find <em>proposals</em> for Utopia. Proposals refer to changes that we, the Utopia Developers, did or might do to Linux and how we might change paradigms for Utopia. We will try to be in depth in how these proposals will or would affect Utopia along with potential pros and cons. The implementations of these proposals may or may not be discussed in future chapters.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="neofhs"><a class="header" href="#neofhs">NeoFHS</a></h2>
<p>NeoFHS stands for Neo (Greek for new) File Hierarchy Standard, it builds up on the old <a href="https://en.wikipedia.org/wiki/Filesystem_Hierarchy_Standard">FreeDesktop File Hierarchy Standard</a>, and tries to make it more intuitive, providing human-readable names in the English language by default.</p>
<h3 id="introduction-1"><a class="header" href="#introduction-1">Introduction</a></h3>
<p>A File Hierarchy Standard (FHS) refers to the way files are stored on your computer. As a Linux user you might be familiar with <code>/home</code> being the home/user folder, <code>/dev</code> being for special or device files, and <code>/bin</code> being where executable files are stored. Someone from Windows would expect <code>C:\Program Files</code> (system) or <code>%localappdata%</code> (user) to contain programs and the user folders to be in <code>C:\Users</code>. The Utopia Developers believe that the FHS has to be clear and concise so that the end user doesn't have any trouble finding things and doesn't get confused by system files that don't matter to them.</p>
<p>The NeoFHS tries to simplify things and remove legacy directories or decisions that where made just to accommodate fragmentation like the /usr merge. It is heavily inspired and based on the <a href="https://gobolinux.org">GoboLinux</a> FHS, but with some improvements in the organization and separation of some types of software. For example in Utopia /Programs (CLI) and /Applications (GUI) are separate.</p>
<p>NeoFHS is built with these ideas in mind:</p>
<ul>
<li>A mother path (root path) should always be capitalized (<code>/Programs</code>, <code>/System</code>)</li>
<li>A path should always be human-readable (this means no <code>/usr</code> or <code>/etc</code>) and use common and simple English words</li>
<li>Paths should be explicit in their name about what they contain</li>
</ul>
<p>Now that we have discussed the reasoning and principals behind the NeoFHS, we can start examining how a common Utopia System is organized.</p>
<pre><code>.
├── Data/               -&gt; Resources that belong to the System, Individual programs or even the user
│   ├── Temporary       -&gt; Data that is ereased on next boot, or at any given moment, non critical information
│   └── Variable/       -&gt; Spool files, log files, etc.
│       ├── cache
│       ├── empty
│       ├── lib
│       ├── lock
│       ├── log
│       ├── run
│       └── spool
├── Core/               -&gt; Indispensable and immutable core of the operating system
│   ├── Boot            -&gt; EFI, bootloader, etc.
│   ├── Libraries       -&gt; Core System libraries, like the libc
│   └── Binaries        -&gt; Core System binaries, like cat, ls, sh, etc. 
├── System/             
│   ├── Settings        -&gt; System or Program config files that are propagated globally.
│   ├── Kernel/         
│   │   ├── Status      -&gt; Kernel status files (part of the /proc fileystem)
│   │   ├── Modules     -&gt; Kernel modules that load after the kernel boots
│   │   └── Objects     -&gt; A view of the kernel's device tree (/sys)
│   ├── Devices         -&gt; Device files managed by udev
│   ├── Library         -&gt; Fonts, Frameworks, Sounds, and other third party additions
│   └── Index/          -&gt; Links to the legacy tree 
│       ├── bin
│       ├── include
│       ├── lib
│       ├── libexec
│       └── share/
│           ├── consolefonts
│           ├── fonts
│           └── man/
│               ├── info
│               └── man{1-9}
├── Applications        -&gt; Sandboxed programs that have a GUI
├── Programs            -&gt; CLI/unsandboxed programs that run on the CLI
├── Users               -&gt; The users home folder
└── Volumes             -&gt; Mountpoints for filesystems or volumes (USBs, External drives)
</code></pre>
<p>As you can see above the new FHS attempts to be more intuitive, using plain English and benefiting from the fact our modern computers can handle very large paths.</p>
<p>Having a modernized FHS is beneficial for some decisions in utopia. For example, this makes having multiple versions of the same package possible. It also has benefits for some Utopia decisions, for example, thanks to this design it is possible to apply a Symlink Style Package Manager, which allows users to have multiple versions of the same package.</p>
<h3 id="surviving-alongside-the-legacy-tree"><a class="header" href="#surviving-alongside-the-legacy-tree">Surviving alongside the legacy tree</a></h3>
<p>One of the first things that might concern you when examining this new FHS is compatibility for literally all programs. The simple solution to this is to use <a href="https://en.wikipedia.org/wiki/Symbolic_link">Symbolic Links</a>. We use symlinks (Symbolic Links) to &quot;link&quot; the new directories to the legacy ones and hide the legacy directories from the user. These links are basically shortcuts that programs follow when they try to use the legacy FHS, so when a program tries to read <code>/etc</code> it instead reads <code>/System/Settings</code>. By using these symlinks we can keep compatibility with the legacy file hierarchy while still presenting a modern hierarchy to the user. <strong>Programs that have not updated to support NeoFHS will continue to work on Utopia without the user noticing.</strong> This is a great compromise since we cannot expect all programs to add dedicated support to Utopia.</p>
<p>Below are legacy FHS directories followed by what they are symlinked to. Click <a href="https://en.wikipedia.org/wiki/Filesystem_Hierarchy_Standard">here</a>. For an explanation of what these directories are for.</p>
<pre><code>/etc            -&gt; /System/Settings
/boot           -&gt; /Core/Boot
/var            -&gt; /Data/Variable
/tmp            -&gt; /Data/Temporary
/home           -&gt; /Users
/proc           -&gt; /System/Kernel/Status
/dev            -&gt; /System/Devices
/sys            -&gt; /System/Kernel/Objects
/bin            -&gt; /System/Index/bin
/lib            -&gt; /System/Index/lib
/lib64          -&gt; /System/Index/lib
/sbin           -&gt; /System/Index/bin
/usr/bin        -&gt; /System/Index/bin
/usr/sbin       -&gt; /System/Index/bin
/usr/share      -&gt; /System/Index/share
/usr/libexec    -&gt; /System/Index/libexec
/usr/include    -&gt; /System/Index/include
</code></pre>
<p>As a developer making programs for Utopia we prefer you support NeoFHS but if you don't include dedicated support these symbolic links will make sure your program works fine. Everything should work as you expect, so if your program reads a file in <code>/etc/settings.toml</code> filesystem magic will redirect your calls to <code>/System/Settings/settings.toml</code>.</p>
<p>As a User, you do not want to see all these legacy directories, so we need to hide them. Linux itself does not have a hidden file system built in like Windows and macOS (putting <code>.</code> in front of these directories is not ideal), but GoboLinux provides a solution for this that we can use that works seamlessly and cleanly.</p>
<p>While you can read about the solution GoboLinux used <a href="https://gobolinux.org/doc/articles/gobohide.html">here</a>, in a nutshell, it keeps a list of the <code>inodes</code> in a kernel linked list. After this, when performing the <code>readdir()</code> syscall, the kernel verifies if said inode is on the <code>inode</code> list. If this is true, it won't be copied to the destination buffer.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="the-utopia-components"><a class="header" href="#the-utopia-components">The Utopia components</a></h1>
<!--- What does this mean -->
<p>This chapter covers essential information about core components of the Utopia Operating System including what they do and why they are vital for the Operating System to function. Note that most if not all the components have their own in depth documentation so its recommended you read those if you are not interested in contributing to any of the core Utopia components.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="winter"><a class="header" href="#winter">Winter</a></h2>
<p>Winter is the <a href="https://en.wikipedia.org/wiki/Package_manager">package manager</a> for the Utopia Operating System. It's responsible for installing, updating, and managing <strong>non-critical system components</strong>. Calling Winter a package manager is somewhat misleading, as libigloo is the one actually doing all the heavy lifting and Winter is simply the CLI frontend.</p>
<p>The core system is managed separately from Winter to provide stability, consistency and <a href="https://www.merriam-webster.com/dictionary/immutable">immutability</a>. This means that Winter itself, libSystem (libc), systemd, and others are not managed by Winter. You are also expected to use flatpak to install graphical applications at least for now but this may change depending on the paths Utopia takes in the future.</p>
<h3 id="introduction-2"><a class="header" href="#introduction-2">Introduction</a></h3>
<p>Winter is based around the concept of Symlink Style Package Management, meaning winter is designed with support for multiple package versions which has benefits in many areas like preventing partial upgrades and preventing issues if a library has not been updated upstream. You can read more about this approach in the <a href="https://www.linuxfromscratch.org/lfs/view/stable/chapter08/pkgmgt.html">LFS guide about package management</a></p>
<p>Winter is designed to heavily integrate into the Utopia Operating System and take advantage of all the changes we have done, including but not limited to NeoFHS, BigBrother, and the (currently unnamed) global configuration database.</p>
<p>All programs installed with Winter are self-contained and stay in their own directories. Instead of having <code>libfoo</code> installed to <code>/usr/lib/libfoo.so</code> it would be installed to <code>/Programs/libfoo/1.0/lib/libfoo.so</code>. You can still find <code>libfoo.so</code> at <code>/usr/lib/libfoo.so</code> or <code>/System/Index/lib/libfoo.so</code>. As you may have guessed from the version number, Winter supports multiple versions, meaning you can have <code>/Programs/libfoo/2.0/lib/libfoo.so</code> at the same time as version 1.0. Supporting multiple versions is beneficial to many people and prevents many problems. A common issue maintainers of distros run into are scenarios where a program relies on an older version of a library, and it cannot be updated (maybe it's a proprietary program or maybe the developer needs more time to work on updating it) but other programs have been updated to <code>libfoo 2.0</code>. The maintainer now either has to hold back packages requiring <code>libfoo 2.0</code> until the other package is updated or drop the package using the old version of the library. Neither of these scenarios are ideal and inevitably cause dependency hell if a package maintainer doesn't sort this out. By supporting multiple versions, Winter avoids all of this.</p>
<p>A real world scenario is 'bar' is a proprietary program that has not been updated to <code>libfoo 2.0</code>. If this mess hasn't been fixed by maintainers of these packages and your package manager only supports one version at a time the result is your package manager trying to downgrade to <code>libfoo 1.0</code> which might not be in the distro's repos anymore and even if it was the second you try to downgrade you will encounter dependency issues where you can't downgrade <code>libfoo</code> because other packages depend on the latest version. This becomes worse recursively as you realize <code>libfoo 1.0</code> might also depend on older versions of other packages and so on. </p>
<p>While the example above mentions a clear example with an older library being required, sometimes it might be an older version of a certain <em>toolchain</em> or <em>programming language</em> that is required. While certain tools like <code>pyenv</code> have emerged to counter this issue, we would like to see something at the system level.</p>
<p>We aren't the first ones trying to implement something like this (thankfully) so we aren't completely in the dark trying to implement this. Here are some examples of other projects that work this way, and reap the benefits:</p>
<ul>
<li>Homebrew (The most popular package manager for macOS)</li>
<li>NIX</li>
<li>GUIX</li>
<li>GoboLinux</li>
</ul>
<p>Some others have picked up the idea and created a sandbox-like environment:</p>
<ul>
<li>Flatpak</li>
<li>Snap</li>
<li>An example of this marketed towards developers would be <a href="https://docker.io">Docker</a></li>
</ul>
<p>Some miscellaneous benefits of Winter are as follows: </p>
<ul>
<li>Easy to uninstall programs: Thanks to the level of integration that Winter has with the Operating System (A benefit we can have because we control all the userland). You can just remove or &quot;trash&quot; a Program under &quot;/Programs&quot; and Winter will remove the rest.</li>
<li>Virtually no conflicts: Because every package is self-contained, it is possible to install two otherwise conflicting packages (Like the example we mentioned above)</li>
<li>Intuitive design: Stop wondering what package installed that new file in your <code>/lib</code> directory. With Winter, you know exactly what files belong to what program.</li>
</ul>
<!--- Maybe remove this one? most package managers provide tools to see what packages made files -->
<h3 id="a-little-view-inside-winter"><a class="header" href="#a-little-view-inside-winter">A little view inside Winter</a></h3>
<p>Please note: This isn't a full view into the Winter internals. To read more about the Winter internals, you can go to Winter's own book by clicking <a href="https://utopiaos.github.io/winter/book">here</a></p>
<p>Winter installs its packages to <code>/Programs</code>, Packages are stored using the following structure: <code>/Programs/ProgramName/Version</code> so for example. Python 3.8 would be stored like this: <code>/Programs/python/3.8</code>. Inside said folder, we would be able to find the typical directories a Python installation might have:</p>
<pre><code>.
├── bin/
│   ├── 2to3
│   ├── pydoc
│   └── python
├── include/
│   └── python3.8
├── lib64/
│   └── python3.8
└── share/
    └── doc
</code></pre>
<p>The depicted above is of course not the full directory tree, as the default directory tree is thousands of files (2566 to be exact), now here is where symlinks come handy again, Winter then links the files to the <code>/System/Index</code>, so for example: </p>
<pre><code>/Programs/python/3.8/bin/python         -&gt; /System/Index/bin/python
/Programs/python/3.8/bin/2to3           -&gt; /System/Index/bin/2to3
/Programs/python/3.8/bin/pydoc          -&gt; /System/Index/bin/pydoc
/Programs/python/3.8/include/python3.8  -&gt; /System/Index/include/python3.8
/Programs/python/3.8/lib64/python3.8    -&gt; /System/Index/lib/python3.8
/Programs/python/3.8/share/doc          -&gt; /System/Index/share/doc
</code></pre>
<p>The way Winter installs and stores packages allows you to select which version is <em>linked</em> to the System Index with ease. You could install Python 3.9, and you'll see the <code>3.8</code> and <code>3.9</code> subdirectories, then just perform the corresponding Winter command to select the version that you wish to link.</p>
<p>If you would like to read about each Winter command and what they do you can click <a href="https://utopiaos.github.io/winter/book">here</a>.</p>
<p>Some other benefits weren't described here in order to avoid extreme complexity, for example <a href="https://utopiaos.github.io/winter/book">Winter environments</a> weren't described here.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="the-utopia-apis"><a class="header" href="#the-utopia-apis">The Utopia APIs</a></h1>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                        
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                            </nav>

        </div>

        
        
        
                <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        
        
                <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
                        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
                
    </body>
</html>
